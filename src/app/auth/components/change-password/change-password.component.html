<div class="auth-container">
  <div class="header-with-back">
    <button type="button" class="btn-icon" (click)="goBack()">
      <i class="fas fa-arrow-left"></i>
    </button>
    <h2>Cambiar contraseña</h2>
  </div>

  <p class="form-description">
    Para cambiar tu contraseña, introduce tu contraseña actual y luego la nueva contraseña que deseas utilizar.
  </p>

  <form [formGroup]="changePasswordForm" (ngSubmit)="onSubmit()">
    <!-- Contraseña actual -->
    <label for="currentPassword">Contraseña actual</label>
    <div class="password-wrapper">
      <input
        [type]="showCurrentPassword ? 'text' : 'password'"
        id="currentPassword"
        formControlName="currentPassword"
        placeholder="••••••••"
      />
      <button type="button" class="toggle-password" (click)="toggleCurrentPassword()">
        <i class="fas" [ngClass]="showCurrentPassword ? 'fa-eye-slash' : 'fa-eye'"></i>
      </button>
    </div>
    <div class="input-error" *ngIf="currentPassword.touched && currentPassword.errors">
      <span *ngIf="currentPassword.errors?.['required']">La contraseña actual es obligatoria.</span>
      <span *ngIf="currentPassword.errors?.['minlength']">La contraseña debe tener al menos 6 caracteres.</span>
    </div>

    <!-- Nueva contraseña -->
    <label for="newPassword">Nueva contraseña</label>
    <div class="password-wrapper">
      <input
        [type]="showNewPassword ? 'text' : 'password'"
        id="newPassword"
        formControlName="newPassword"
        placeholder="••••••••"
      />
      <button type="button" class="toggle-password" (click)="toggleNewPassword()">
        <i class="fas" [ngClass]="showNewPassword ? 'fa-eye-slash' : 'fa-eye'"></i>
      </button>
    </div>
    <div class="input-error" *ngIf="newPassword.touched && newPassword.errors">
      <span *ngIf="newPassword.errors?.['required']">La nueva contraseña es obligatoria.</span>
      <span *ngIf="newPassword.errors?.['minlength']">La contraseña debe tener al menos 6 caracteres.</span>
    </div>

    <!-- Confirmar nueva contraseña -->
    <label for="confirmPassword">Confirmar nueva contraseña</label>
    <div class="password-wrapper">
      <input
        [type]="showConfirmPassword ? 'text' : 'password'"
        id="confirmPassword"
        formControlName="confirmPassword"
        placeholder="••••••••"
      />
      <button type="button" class="toggle-password" (click)="toggleConfirmPassword()">
        <i class="fas" [ngClass]="showConfirmPassword ? 'fa-eye-slash' : 'fa-eye'"></i>
      </button>
    </div>
    <div class="input-error" *ngIf="confirmPassword.touched && confirmPassword.errors">
      <span *ngIf="confirmPassword.errors?.['required']">Debes confirmar la nueva contraseña.</span>
      <span *ngIf="confirmPassword.errors?.['passwordMismatch']">Las contraseñas no coinciden.</span>
    </div>

    <!-- Botón de envío -->
    <button type="submit" [disabled]="changePasswordForm.invalid || isLoading">
      <span *ngIf="!isLoading">Cambiar contraseña</span>
      <span *ngIf="isLoading" class="spinner"><i class="fas fa-spinner fa-spin"></i></span>
    </button>

    <p *ngIf="errorMessage" class="error">{{ errorMessage }}</p>
    <p *ngIf="successMessage" class="success">{{ successMessage }}</p>
  </form>

  <div class="password-recommendations">
    <h3>Recomendaciones de seguridad</h3>
    <ul>
      <li>Usa al menos 8 caracteres</li>
      <li>Incluye letras mayúsculas y minúsculas</li>
      <li>Añade números y símbolos</li>
      <li>Evita contraseñas que hayas usado antes</li>
      <li>No uses información personal fácil de adivinar</li>
    </ul>
  </div>
</div>
